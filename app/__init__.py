from flask import Flask

from pycomputer.memory import MemoryHandler


ram_size = 256
cache_size = 32
cache_line_size = 4
cache_associativity = 2

memory_handler = MemoryHandler(
	ram_size=ram_size,
	cache_size=cache_size,
	cache_line_size=cache_line_size,
	cache_associativity=cache_associativity)

# Load some initial data
init_data = (
	b"\x02\x06\x06\x01\x05\x01\x06\x06\x04\x08\x06\x08\x05\x00\x02\x02" +
	b"\x06\x02\x08\x03\x09\x00\x00\x02\x04\x02\x06\x09\x00\x06\x02\x09" +
	b"\x02\x04\x04\x06\x06\x04\x01\x04\x06\x04\x06\x09\x01\x01\x06\x03" +
	b"\x02\x02\x05\x01\x00\x04\x05\x08\x03\x03\x03\x01\x03\x08\x08\x00" +
	b"\x00\x00\x07\x09\x00\x05\x06\x01\x04\x05\x04\x05\x07\x03\x08\x08" +
	b"\x03\x09\x09\x06\x05\x03\x00\x03\x07\x09\x07\x07\x08\x09\x07\x04" +
	b"\x06\x03\x03\x00\x06\x04\x05\x08\x08\x04\x03\x09\x04\x00\x02\x00" +
	b"\x09\x00\x05\x05\x01\x01\x06\x06\x00\x07\x01\x09\x04\x08\x06\x02" +
	b"\x08\x05\x02\x00\x01\x04\x05\x01\x05\x06\x05\x09\x05\x06\x00\x09" +
	b"\x08\x09\x02\x03\x04\x04\x07\x04\x00\x04\x08\x04\x01\x03\x03\x05" +
	b"\x09\x03\x00\x05\x09\x00\x03\x03\x03\x01\x09\x06\x04\x07\x03\x06" +
	b"\x06\x09\x03\x07\x01\x03\x07\x01\x07\x01\x04\x06\x06\x04\x02\x02" +
	b"\x05\x07\x04\x08\x04\x05\x01\x03\x09\x06\x03\x05\x07\x07\x01\x07" +
	b"\x06\x00\x00\x03\x07\x01\x02\x04\x08\x08\x09\x08\x00\x07\x08\x06" +
	b"\x03\x04\x06\x03\x01\x00\x06\x00\x01\x08\x07\x01\x07\x07\x03\x02" +
	b"\x04\x05\x06\x04\x04\x06\x02\x08\x02\x08\x04\x08\x01\x00\x07\x03")
memory_handler.load_ram_from_bytearray(init_data)



def create_app():
	app = Flask(__name__)


	# Blueprint registration
	from app.memory import bp as memory_bp
	app.register_blueprint(memory_bp)

	return app
